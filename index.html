<!DOCTYPE html><html>
<head>
<title>Saharsh Gobinath Clicker</title>
<style>
  .clicker-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
  .clicker-image-container {
    width: 300px;
    height: 300px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    overflow: hidden;
    transition: 0.1s;
    pointer-events: auto;
  }
  .clicker-image {
    width: 300px;
    position: relative;
    top: 50%;
    transform: translateY(-50%);
  }
  .clicker-image-container:hover {
    transform: translate(-50%, -50%) scale(1.1);
    transition: 0.3s;
  }
  .clicker-image-container:active {
    transform: translate(-50%, -50%) scale(1.5);
    transition: 0s;
  }
  #clicker-count {
    font-size: 30px;
    text-align: center;
  }
  .clicker-section {
    position: fixed;
    top: 5%;
    left: 5%;
    width: 90%;
    height: 90%;
    background-color: #ffffff;
    text-align: center;
  }
  body {
    background-image: url("https://asset-cdn.schoology.com/system/files/imagecache/profile_big/pictures/picture-c0b09cdead19788fb0f8be0d53b5c572_68c34cd700b90.jpg");
    background-size: 50px;
    cursor: none;
  }
  #customCursor {
    object-fit: cover;
    width: 20px;
    height: 20px;
    pointer-events: none;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 99999999;
  }
  .upgrade-svg {
    width: 50px;
    height: 50px;
    background-color: #cccccc;
    border-radius: 50%;
    position: fixed;
    top: calc(5% + 10px);
    left: calc(5% + 10px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: 0.2s;
  }
  .upgrade-svg:hover {
    background-color: #bbbbbb;
  }
  .upgrade-item {
    width: 100%;
    margin: 10px 0 10px 0;
    padding-top: 10px;
    padding-bottom: 10px;
    font-size: 3em;
    background-color: #eee;
  }
  .upgrade-item.locked {
    opacity: 0.5;
    pointer-events: none;
    background-color: #ddd;
  }
  .upgrade-item.locked:hover {
    background-color: #ddd;
  }
  .upgrade-item.hidden {
    opacity: 0.4;
    pointer-events: none;
    background-color: #e8e8e8;
  }
  .upgrade-item.hidden:hover {
    background-color: #e8e8e8;
  }
  #upgrade-section {
    width: 100%;
    height: 100%;
    overflow-y: auto;
  }
  .small {
    font-size: 0.7em;
  }

  .click-particle {
    position: fixed;
    pointer-events: none;
    font-weight: bold;
    font-size: 20px;
    color: #e74c3c;
    z-index: 999999;
    animation: particleFly 1.2s ease-out forwards;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  }
  @keyframes particleFly {
    0% { opacity: 1; transform: translateY(0) scale(1); }
    100% { opacity: 0; transform: translateY(-120px) scale(0.5); }
  }

  #stats-bar {
    position: absolute;
    top: 10px;
    right: 10px;
    text-align: right;
    font-size: 14px;
    color: #555;
    font-family: monospace;
    line-height: 1.6;
  }

  .rebirth-svg {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #f39c12, #e74c3c);
    border-radius: 50%;
    position: fixed;
    top: calc(5% + 10px);
    left: calc(5% + 70px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
    transition: 0.2s;
  }
  .rebirth-svg:hover {
    transform: scale(1.15);
    box-shadow: 0 0 20px rgba(231, 76, 60, 0.8);
  }

  .settings-svg {
    width: 50px;
    height: 50px;
    background-color: #cccccc;
    border-radius: 50%;
    position: fixed;
    top: calc(5% + 10px);
    left: calc(5% + 130px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: 0.2s;
  }
  .settings-svg:hover {
    background-color: #bbbbbb;
    transform: rotate(45deg);
  }

  .achievement-btn-svg {
    width: 50px;
    height: 50px;
    background-color: #cccccc;
    border-radius: 50%;
    position: fixed;
    top: calc(5% + 10px);
    left: calc(5% + 190px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: 0.2s;
    font-size: 24px;
    user-select: none;
  }
  .achievement-btn-svg:hover {
    background-color: #f1c40f;
    transform: scale(1.1);
  }

  .modal-overlay {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.6);
    z-index: 9999999;
    display: none;
    align-items: center;
    justify-content: center;
  }
  .modal-overlay.active {
    display: flex;
  }
  .modal-box {
    background: #fff;
    border-radius: 16px;
    padding: 40px;
    max-width: 500px;
    width: 90%;
    text-align: center;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    animation: modalIn 0.3s ease-out;
  }
  @keyframes modalIn {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }
  .modal-box h2 {
    margin: 0 0 15px 0;
    font-size: 28px;
    background: linear-gradient(135deg, #f39c12, #e74c3c);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  .modal-box p {
    color: #555;
    font-size: 16px;
    line-height: 1.6;
  }
  .modal-btn {
    padding: 12px 30px;
    margin: 8px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: 0.2s;
  }
  .modal-btn.confirm {
    background: linear-gradient(135deg, #f39c12, #e74c3c);
    color: white;
  }
  .modal-btn.confirm:hover { transform: scale(1.05); }
  .modal-btn.cancel {
    background: #ddd;
    color: #333;
  }
  .modal-btn.cancel:hover { background: #ccc; }

  .settings-modal .modal-box {
    text-align: left;
  }
  .settings-modal .modal-box h2 {
    text-align: center;
    background: linear-gradient(135deg, #3498db, #2ecc71);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  .settings-btn {
    display: block;
    width: 100%;
    padding: 12px 20px;
    margin: 8px 0;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 15px;
    cursor: pointer;
    background: #f9f9f9;
    text-align: left;
    transition: 0.2s;
  }
  .settings-btn:hover { border-color: #aaa; background: #eee; }
  .settings-btn.danger { border-color: #e74c3c; color: #e74c3c; }
  .settings-btn.danger:hover { background: #fde; }

  /* Achievement modal */
  .achievement-modal .modal-box {
    max-width: 750px;
    max-height: 85vh;
    overflow-y: auto;
    text-align: center;
  }
  .achievement-modal .modal-box h2 {
    background: linear-gradient(135deg, #f1c40f, #e67e22);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  #achievement-count {
    font-size: 15px;
    color: #888;
    margin-bottom: 5px;
  }
  #achievement-progress-bar {
    width: 80%;
    max-width: 400px;
    height: 10px;
    background: #eee;
    border-radius: 5px;
    margin: 8px auto 20px auto;
    overflow: hidden;
  }
  #achievement-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #f1c40f, #e67e22, #e74c3c);
    border-radius: 5px;
    transition: width 0.4s;
    width: 0%;
  }
  .ach-category-label {
    font-size: 16px;
    font-weight: bold;
    color: #555;
    margin: 20px 0 10px 0;
    padding-bottom: 5px;
    border-bottom: 2px solid #eee;
    text-align: left;
  }
  #achievement-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
    gap: 10px;
    margin: 0 0 20px 0;
  }
  .achievement-card {
    background: #f5f5f5;
    border: 2px solid #ddd;
    border-radius: 10px;
    padding: 12px 10px;
    text-align: center;
    transition: 0.2s;
  }
  .achievement-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  .achievement-card.unlocked {
    background: #eafaf1;
    border-color: #2ecc71;
  }
  .achievement-card.locked {
    opacity: 0.45;
  }
  .achievement-card .ach-icon {
    font-size: 28px;
    margin-bottom: 4px;
  }
  .achievement-card .ach-name {
    font-weight: bold;
    font-size: 13px;
    margin-bottom: 3px;
    color: #333;
  }
  .achievement-card.locked .ach-name {
    color: #999;
  }
  .achievement-card .ach-desc {
    font-size: 11px;
    color: #888;
    line-height: 1.3;
  }

  .achievement-toast {
    position: fixed;
    bottom: 20px;
    right: -400px;
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    color: white;
    padding: 15px 25px;
    border-radius: 12px;
    font-size: 16px;
    z-index: 9999998;
    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    transition: right 0.5s ease;
    max-width: 350px;
  }
  .achievement-toast.show {
    right: 20px;
  }
  .achievement-toast strong {
    display: block;
    font-size: 14px;
    opacity: 0.8;
    margin-bottom: 4px;
  }

  #milestone-bar-container {
    width: 80%;
    max-width: 400px;
    height: 8px;
    background: #eee;
    border-radius: 4px;
    margin: 5px auto;
    overflow: hidden;
  }
  #milestone-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #3498db, #9b59b6, #e74c3c);
    border-radius: 4px;
    transition: width 0.3s;
    width: 0%;
  }
  #milestone-label {
    font-size: 12px;
    color: #888;
    margin-bottom: 5px;
  }

  #combo-display {
    position: absolute;
    top: 28%;
    left: 50%;
    transform: translateX(-50%);
    font-size: 18px;
    font-weight: bold;
    color: #e74c3c;
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
    z-index: 50;
  }
  #combo-display.active {
    opacity: 1;
  }

  #prestige-display {
    font-size: 14px;
    color: #f39c12;
    margin: 2px 0;
  }

  #total-clicks-display {
    font-size: 12px;
    color: #aaa;
    margin: 2px 0;
  }

  #golden-saharsh {
    position: absolute;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    overflow: hidden;
    cursor: pointer;
    pointer-events: auto;
    z-index: 100;
    animation: goldenFloat 3s ease-in-out infinite, goldenGlow 1s ease-in-out infinite alternate;
    display: none;
    box-shadow: 0 0 20px rgba(243, 156, 18, 0.8);
  }
  #golden-saharsh img {
    width: 100%;
    filter: sepia(1) saturate(3) hue-rotate(15deg) brightness(1.2);
  }
  @keyframes goldenFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-15px); }
  }
  @keyframes goldenGlow {
    from { box-shadow: 0 0 15px rgba(243, 156, 18, 0.6); }
    to { box-shadow: 0 0 30px rgba(243, 156, 18, 1); }
  }

  /* SHAKE ON WRAPPER ‚Äî not on the clicker itself */
  @keyframes screenShake {
    0%, 100% { transform: translate(0, 0); }
    25% { transform: translate(-4px, 3px); }
    50% { transform: translate(4px, -3px); }
    75% { transform: translate(-3px, -4px); }
  }
  .shaking {
    animation: screenShake 0.15s ease-in-out;
  }

  #bulk-buy-toggle {
    position: fixed;
    bottom: calc(5% + 10px);
    left: calc(5% + 10px);
    padding: 8px 16px;
    background: #3498db;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    cursor: pointer;
    z-index: 100;
    transition: 0.2s;
  }
  #bulk-buy-toggle:hover { background: #2980b9; }
</style>
</head>
<body>
<div class="clicker-section" id="clicker-game-section">
  <div id="upgrade-svg" class="upgrade-svg" title="Upgrades">
    <svg width="30px" height="30px" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v13m0-13 4 4m-4-4-4 4"/>
    </svg>
  </div>

  <div id="rebirth-svg" class="rebirth-svg" title="Rebirth">
    <svg width="30px" height="30px" xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24">
      <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
    </svg>
  </div>

  <div id="settings-svg" class="settings-svg" title="Settings">
    <svg width="30px" height="30px" xmlns="http://www.w3.org/2000/svg" fill="#555" viewBox="0 0 24 24">
      <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.49.49 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.49.49 0 00-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6A3.6 3.6 0 1112 8.4a3.6 3.6 0 010 7.2z"/>
    </svg>
  </div>

  <div id="achievement-svg" class="achievement-btn-svg" title="Achievements">üèÜ</div>

  <div id="stats-bar">
    <div id="prestige-display">‚≠ê Rebirth: 0 | Multiplier: x1.00</div>
    <div>SPS: <span id="sps-display">0</span> | Power: <span id="power-display">1</span></div>
    <div id="total-clicks-display">Total Clicks: 0</div>
  </div>

  <h1>Saharsh Clicker</h1>
  <pre id="clicker-count">0x Saharsh</pre>
  <div id="prestige-display-main"></div>
  <div id="milestone-label">Next: Person of the day (60 Saharsh)</div>
  <div id="milestone-bar-container"><div id="milestone-bar-fill"></div></div>
  <div id="combo-display">üî• Combo x1</div>
  <!-- Shake wrapper ‚Äî separate from clicker transforms -->
  <div class="clicker-container" id="clicker-container">
    <div class="clicker-image-container" id="clicker"><img class="clicker-image" src="https://asset-cdn.schoology.com/system/files/imagecache/profile_big/pictures/picture-c0b09cdead19788fb0f8be0d53b5c572_68c34cd700b90.jpg"></div>
  </div>

  <div id="golden-saharsh"><img src="https://asset-cdn.schoology.com/system/files/imagecache/profile_big/pictures/picture-c0b09cdead19788fb0f8be0d53b5c572_68c34cd700b90.jpg"></div>
</div>

<div class="clicker-section" style="display:none" id="clicker-upgrade-section">
  <div id="exit-upgrade-svg" class="upgrade-svg" title="Back">
    <svg width="30px" height="30px" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" style="transform:rotate(180deg)">
      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v13m0-13 4 4m-4-4-4 4"/>
    </svg>
  </div>
  <h1>Saharsh Clicker</h1>
  <h1>Upgrades</h1>
  <button id="bulk-buy-toggle">Buy: x1</button>
  <div id="upgrade-section"></div>
</div>

<!-- Rebirth Modal -->
<div class="modal-overlay" id="rebirth-modal">
  <div class="modal-box">
    <h2>üîÑ Rebirth</h2>
    <p id="rebirth-info">
      Reset all progress to gain a permanent multiplier!<br><br>
      <strong>Current Multiplier:</strong> <span id="rebirth-current-mult">x1.00</span><br>
      <strong>New Multiplier:</strong> <span id="rebirth-new-mult">x1.00</span><br>
      <strong>Rebirth Tokens Earned:</strong> <span id="rebirth-tokens-earned">0</span><br><br>
      <span id="rebirth-requirement" style="color:#e74c3c"></span>
    </p>
    <button class="modal-btn confirm" id="rebirth-confirm-btn">Rebirth!</button>
    <button class="modal-btn cancel" id="rebirth-cancel-btn">Cancel</button>
  </div>
</div>

<!-- Settings Modal -->
<div class="modal-overlay settings-modal" id="settings-modal">
  <div class="modal-box">
    <h2>‚öôÔ∏è Settings</h2>
    <button class="settings-btn" id="export-save-btn">üì§ Export Save</button>
    <button class="settings-btn" id="import-save-btn">üì• Import Save</button>
    <button class="settings-btn" id="toggle-particles-btn">‚ú® Particles: ON</button>
    <button class="settings-btn" id="toggle-shake-btn">üì≥ Screen Shake: ON</button>
    <button class="settings-btn" id="toggle-sound-btn">üîä Click Sound: ON</button>
    <button class="settings-btn danger" id="hard-reset-btn">üóëÔ∏è Hard Reset (Delete Everything)</button>
    <br>
    <button class="modal-btn cancel" id="settings-close-btn">Close</button>
  </div>
</div>

<!-- Achievement Modal -->
<div class="modal-overlay achievement-modal" id="achievement-modal">
  <div class="modal-box">
    <h2>üèÜ Achievements</h2>
    <p id="achievement-count">0 / 0 Unlocked</p>
    <div id="achievement-progress-bar"><div id="achievement-progress-fill"></div></div>
    <div id="achievement-list-container"></div>
    <br>
    <button class="modal-btn cancel" id="achievement-close-btn">Close</button>
  </div>
</div>

<!-- Achievement Toast -->
<div class="achievement-toast" id="achievement-toast">
  <strong>üèÜ Achievement Unlocked!</strong>
  <span id="achievement-text"></span>
</div>

<img id="customCursor" src="https://asset-cdn.schoology.com/system/files/imagecache/profile_big/pictures/picture-c0b09cdead19788fb0f8be0d53b5c572_68c34cd700b90.jpg">
<script>let ALERTED182735123048123423481 = false;addEventListener("error",(e)=>{if(ALERTED182735123048123423481)return;ALERTED182735123048123423481=true;alert(e.message)})</script>
<!-- start of "normal person" blocker -->
<div id=d0082e1c-16cc-4a7e-b920-d2b5bf8c3ce1 style=position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fff;z-index:2147483649>Validating authentication state. Login at the <a href=/ >home page</a></div><script>try{localStorage.getItem("userIsValidated")?document.getElementById("d0082e1c-16cc-4a7e-b920-d2b5bf8c3ce1").remove():window.location.replace("/")}catch(e){window.location.replace("/")}</script>
<!-- end of "normal person" blocker -->
<script>
  const GAMEVERSION = "dev-1.0.0"

  const COST_MULTIPLIER = 1.5;
  const REBIRTH_THRESHOLD = 10000;
  const REBIRTH_MULT_PER_TOKEN = 0.1;

  let clicker = document.getElementById("clicker")
  let clickerCountElement = document.getElementById("clicker-count")
  let upgradeSection = document.getElementById("upgrade-section")

  class Upgrade {
    constructor (clicks, autoclicks, title, subtitle="auto", cost="auto") {
      this.cost = cost==="auto"?clicks*100+autoclicks*60:cost
      this.title = title
      this.subtitle = subtitle==="auto"?((clicks===0?"":clicks+" Saharsh Power\n")+(autoclicks===0?"":autoclicks+" SPS")):subtitle
      this.clicks = clicks
      this.autoclicks = autoclicks
    }
  }

  let avaliableUpgrades = [
    new Upgrade(0, 1, "Person of the day", "+1 SPS(Saharsh Per Second)"),
    new Upgrade(1, 0, "Centrix81 Addiction", "+1 Saharsh Power"),
    new Upgrade(0, 5, "SPED class", "+5 SPS(Saharsh Per Second)"),
    new Upgrade(0, 10, "Leaked yearbook photo", "+10 SPS(Saharsh Per Second)"),
    new Upgrade(25, 0, "2.5 GPA"),
    new Upgrade(0, 70, "Gets hacked"),
    new Upgrade(100, 0, "70 IQ"),
    new Upgrade(190, 190, "\"Below Average\" on CAST test"),
    new Upgrade(200, 200, "2.0 GPA"),
    new Upgrade(0, 674, "Leaked IP Address(205.173.47.249)"),
    new Upgrade(0, 706, "Leaked Bio ID", "+K706 SPS where K is 1 and K706 is Saharsh's Bio ID"),
    new Upgrade(0, 1000, "Forgot discord account password"),
    new Upgrade(0, 1973, "Owner of 1973 Member Group Chat", "at Oct 31, 7:19 PM\n+1973 SPS"),
    new Upgrade(5000, 0, "60 IQ"),
    new Upgrade(0, 5000, "50 IQ"),
    new Upgrade(7463, 0, "Owner of 7463 Member Group Chat", "at Nov 4, 7:48 AM\n+7463 Saharsh Power"),
    new Upgrade(15000, 0, "1.5 GPA"),
    new Upgrade(10000, 10000, "Saharsh in 7th grade"),
    new Upgrade(20000, 20000, "1.0 GPA"),
    new Upgrade(0, 49603, "Leaked Food Service Account Number"),
    new Upgrade(51486, 0, "Leaked Insurance Plan ID: W0051486"),
    new Upgrade(100000, 0, "0.5 GPA"),
    new Upgrade(0, 100000, "40 IQ"),
    new Upgrade(300000, 0, "30 IQ"),
    new Upgrade(0, 300000, "0.0 GPA"),
    new Upgrade(500000, 500000, "Leaked Social Security Number"),
    new Upgrade(1000000, 0, "20 IQ"),
    new Upgrade(0, 1000000, "10 IQ"),
    new Upgrade(5000000, 5000000, "Skipped Tetanus, Diphtheria and Acellular Pertussis (Tdap) vaccine"),
    new Upgrade(5250578, 0, "Leaked ID Number"),
    new Upgrade(10000000, 10000000, "0 IQ"),
    new Upgrade(909343909, 909343909, "Leaked Insurance Member ID:", "TGX909343909\n+909343909 Saharsh Power\n+909343909 SPS"),
    new Upgrade(1000000000, 0, "Broken computer"),
    new Upgrade(0, 1000000000, "Saharsh's Apparatus"),
    new Upgrade(2000000000, 0, "Captcha Passer"),
    new Upgrade(0, 2000000000, "-0.5 GPA"),
    new Upgrade(10000000000, 0, "-10 IQ"),
    new Upgrade(0, 10000000000, "Rejected from Harvard"),
    new Upgrade(100000000000, 0, "Minimum Wage Worker"),
    new Upgrade(0, 100000000000, "-1.0 GPA"),
    new Upgrade(1000000000000, 0, "AI Chimpanzee"),
    new Upgrade(10000000000000, 0, "-20 IQ"),
    new Upgrade(100000000000000, 0, "Saharsh's ChatGPT History Leaked"),
    new Upgrade(0, 1000000000000000, "Free Minecoins"),
    new Upgrade(1000000000000000, 1000000000000000, "Free Saharsh IDs"),
    new Upgrade(0, 10000000000000000, "Calvin's Master Plan"),
    new Upgrade(10000000000000000, 0, "\"Centrix82\""),
    new Upgrade(10000000000000000000, 0, "Where was Saharsh during 9/11/01?"),
    new Upgrade(0, 10000000000000000000, "Why are you still here"),
    new Upgrade(1000000000000000000000000, 1000000000000000000000000, "Saharsh", "Final upgrade\n+1000000000000000000000000 Saharsh Power\n+1000000000000000000000000 SPS")
  ];

  let gameState = {
    clickerCount: 0,
    ownedUpgrades: new Array(avaliableUpgrades.length).fill(0),
    rebirthCount: 0,
    rebirthTokens: 0,
    totalClicks: 0,
    totalSaharshEarned: 0,
    goldenClicks: 0,
    achievements: [],
    settings: {
      particles: true,
      screenShake: true,
      clickSound: true
    }
  }

  let clickPower = 1;
  let autoPerSec = 0;
  let autoAccumulator = 0;
  let bulkBuyAmount = 1;
  const bulkOptions = [1, 5, 10, 25, 100];
  let bulkIndex = 0;

  let comboCount = 0;
  let comboTimer = null;
  let lastClickTime = 0;
  let peakCombo = 0;

  function getRebirthMultiplier() {
    return 1 + gameState.rebirthTokens * REBIRTH_MULT_PER_TOKEN;
  }

  function computePowers() {
    clickPower = 1;
    autoPerSec = 0;
    for (let i = 0; i < avaliableUpgrades.length; ++i) {
      let upgrade = avaliableUpgrades[i];
      let owned = gameState.ownedUpgrades[i] || 0;
      clickPower += upgrade.clicks * owned;
      autoPerSec += upgrade.autoclicks * owned;
    }
    let mult = getRebirthMultiplier();
    clickPower = Math.floor(clickPower * mult);
    autoPerSec = Math.floor(autoPerSec * mult);
  }

  if (localStorage.getItem("gameState-v" + GAMEVERSION)) {
    try {
      let saved = JSON.parse(localStorage.getItem("gameState-v" + GAMEVERSION));
      gameState = { ...gameState, ...saved };
      if (!gameState.ownedUpgrades) {
        gameState.ownedUpgrades = new Array(avaliableUpgrades.length).fill(0);
      }
      while (gameState.ownedUpgrades.length < avaliableUpgrades.length) {
        gameState.ownedUpgrades.push(0);
      }
      let ds = { particles: true, screenShake: true, clickSound: true };
      gameState.settings = { ...ds, ...(gameState.settings || {}) };
      if (!gameState.achievements) gameState.achievements = [];
      if (gameState.goldenClicks === undefined) gameState.goldenClicks = 0;
    } catch (e) {
      alert("Error in save state parsing");
      gameState = {
        clickerCount: 0,
        ownedUpgrades: new Array(avaliableUpgrades.length).fill(0),
        rebirthCount: 0, rebirthTokens: 0,
        totalClicks: 0, totalSaharshEarned: 0, goldenClicks: 0,
        achievements: [],
        settings: { particles: true, screenShake: true, clickSound: true }
      };
    }
  }

  computePowers();

  // ===== Number formatting =====
  function formatNumber(n) {
    n = Math.floor(n);
    if (n < 1000) return n.toString();
    const suffixes = ['','K','M','B','T','Qa','Qi','Sx','Sp','Oc','No','Dc',
      'UDc','DDc','TDc','QaDc','QiDc','SxDc','SpDc','OcDc','NoDc','Vg'];
    let tier = Math.floor(Math.log10(Math.abs(n)) / 3);
    if (tier >= suffixes.length) tier = suffixes.length - 1;
    if (tier === 0) return n.toString();
    let scaled = n / Math.pow(10, tier * 3);
    return scaled.toFixed(2) + suffixes[tier];
  }

  function updateCountDisplay() {
    clickerCountElement.innerText = `${formatNumber(gameState.clickerCount)}x Saharsh`;
  }
  updateCountDisplay();

  function updateStatsDisplay() {
    document.getElementById("sps-display").textContent = formatNumber(autoPerSec);
    document.getElementById("power-display").textContent = formatNumber(clickPower);
    document.getElementById("prestige-display").textContent =
      `‚≠ê Rebirth: ${gameState.rebirthCount} | Multiplier: x${getRebirthMultiplier().toFixed(2)}`;
    document.getElementById("total-clicks-display").textContent =
      `Total Clicks: ${formatNumber(gameState.totalClicks)} | Total Earned: ${formatNumber(gameState.totalSaharshEarned)}`;
  }
  updateStatsDisplay();

  // ===== Click particles =====
  function spawnParticle(x, y, text) {
    if (!gameState.settings.particles) return;
    let p = document.createElement("div");
    p.className = "click-particle";
    p.textContent = text;
    p.style.left = (x + (Math.random() - 0.5) * 60) + "px";
    p.style.top = y + "px";
    document.body.appendChild(p);
    setTimeout(() => p.remove(), 1200);
  }

  // ===== Screen shake ‚Äî applied to WRAPPER, not the clicker =====
  function triggerShake() {
    if (!gameState.settings.screenShake) return;
    let el = document.getElementById("clicker-container");
    el.classList.remove("shaking");
    void el.offsetWidth; // force reflow to restart animation
    el.classList.add("shaking");
    setTimeout(() => el.classList.remove("shaking"), 150);
  }

  // ===== Click sound =====
  let audioCtx = null;
  function playClickSound() {
    if (!gameState.settings.clickSound) return;
    try {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      let osc = audioCtx.createOscillator();
      let gain = audioCtx.createGain();
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.frequency.value = 400 + Math.random() * 300;
      osc.type = "sine";
      gain.gain.setValueAtTime(0.08, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
      osc.start();
      osc.stop(audioCtx.currentTime + 0.1);
    } catch(e) {}
  }

  // ===== Combo system =====
  function updateCombo() {
    let now = Date.now();
    if (now - lastClickTime < 500) {
      comboCount++;
    } else {
      comboCount = 1;
    }
    lastClickTime = now;
    if (comboCount > peakCombo) peakCombo = comboCount;

    let comboDisplay = document.getElementById("combo-display");
    if (comboCount >= 3) {
      comboDisplay.textContent = `üî• Combo x${comboCount}`;
      comboDisplay.classList.add("active");
      comboDisplay.style.fontSize = Math.min(18 + comboCount * 2, 50) + "px";
    } else {
      comboDisplay.classList.remove("active");
    }

    clearTimeout(comboTimer);
    comboTimer = setTimeout(() => {
      comboCount = 0;
      comboDisplay.classList.remove("active");
    }, 800);
  }

  function getComboMultiplier() {
    if (comboCount < 3) return 1;
    return 1 + (comboCount - 2) * 0.1;
  }

  // ===== Achievements =====
  const achievementDefs = [
    // ‚Äî Clicking ‚Äî
    { cat: "üñ±Ô∏è Clicking", id: "first_click", name: "Baby Steps", desc: "Click Saharsh for the first time", check: () => gameState.totalClicks >= 1 },
    { cat: "üñ±Ô∏è Clicking", id: "100_clicks", name: "Dedicated Clicker", desc: "Click 100 times", check: () => gameState.totalClicks >= 100 },
    { cat: "üñ±Ô∏è Clicking", id: "1000_clicks", name: "Finger Workout", desc: "Click 1,000 times", check: () => gameState.totalClicks >= 1000 },
    { cat: "üñ±Ô∏è Clicking", id: "10000_clicks", name: "Carpal Tunnel", desc: "Click 10,000 times", check: () => gameState.totalClicks >= 10000 },
    { cat: "üñ±Ô∏è Clicking", id: "100000_clicks", name: "RSI Diagnosis", desc: "Click 100,000 times", check: () => gameState.totalClicks >= 100000 },
    { cat: "üñ±Ô∏è Clicking", id: "1m_clicks", name: "Professional Clicker", desc: "Click 1,000,000 times", check: () => gameState.totalClicks >= 1000000 },
    { cat: "üñ±Ô∏è Clicking", id: "10m_clicks", name: "Mass Extinction of Mice", desc: "Click 10,000,000 times", check: () => gameState.totalClicks >= 10000000 },
    { cat: "üñ±Ô∏è Clicking", id: "impossible_clicks", name: "just a bit of clicks", desc: "Click for a bit yknow?", check: () => gameState.totalClicks >= 10000000000000000000000000000000000000 },

    // ‚Äî Earning ‚Äî
    { cat: "üí∞ Earning", id: "100_saharsh", name: "Saharsh Collector", desc: "Earn 100 Saharsh total", check: () => gameState.totalSaharshEarned >= 100 },
    { cat: "üí∞ Earning", id: "10000_saharsh", name: "Saharsh Hoarder", desc: "Earn 10,000 Saharsh total", check: () => gameState.totalSaharshEarned >= 10000 },
    { cat: "üí∞ Earning", id: "1m_saharsh", name: "Saharsh Millionaire", desc: "Earn 1 Million Saharsh total", check: () => gameState.totalSaharshEarned >= 1e6 },
    { cat: "üí∞ Earning", id: "1b_saharsh", name: "Saharsh Billionaire", desc: "Earn 1 Billion Saharsh total", check: () => gameState.totalSaharshEarned >= 1e9 },
    { cat: "üí∞ Earning", id: "1t_saharsh", name: "Saharsh Trillionaire", desc: "Earn 1 Trillion Saharsh total", check: () => gameState.totalSaharshEarned >= 1e12 },
    { cat: "üí∞ Earning", id: "1qa_saharsh", name: "Saharsh Quadrillionaire", desc: "Earn 1 Quadrillion Saharsh total", check: () => gameState.totalSaharshEarned >= 1e15 },
    { cat: "üí∞ Earning", id: "1qi_saharsh", name: "Beyond Comprehension", desc: "Earn 1 Quintillion Saharsh total", check: () => gameState.totalSaharshEarned >= 1e18 },
    { cat: "üí∞ Earning", id: "1sx_saharsh", name: "Saharsh Singularity", desc: "Earn 1 Sextillion Saharsh total", check: () => gameState.totalSaharshEarned >= 1e21 },
    { cat: "üí∞ Earning", id: "impossible_saharsh", name: "a litle bit of saharsh", desc: "Earn a little bit of saharsh", check: () => gameState.totalSaharshEarned >= 1e100 },

    // ‚Äî Rebirth ‚Äî
    { cat: "üîÑ Rebirth", id: "first_rebirth", name: "Born Again", desc: "Rebirth for the first time", check: () => gameState.rebirthCount >= 1 },
    { cat: "üîÑ Rebirth", id: "5_rebirth", name: "Rebirth Addict", desc: "Rebirth 5 times", check: () => gameState.rebirthCount >= 5 },
    { cat: "üîÑ Rebirth", id: "10_rebirth", name: "Eternal Cycle", desc: "Rebirth 10 times", check: () => gameState.rebirthCount >= 10 },
    { cat: "üîÑ Rebirth", id: "25_rebirth", name: "Rebirth Enthusiast", desc: "Rebirth 25 times", check: () => gameState.rebirthCount >= 25 },
    { cat: "üîÑ Rebirth", id: "50_rebirth", name: "Rebirth Maniac", desc: "Rebirth 50 times", check: () => gameState.rebirthCount >= 50 },
    { cat: "üîÑ Rebirth", id: "100_rebirth", name: "Century of Rebirth", desc: "Rebirth 100 times", check: () => gameState.rebirthCount >= 100 },
    { cat: "üîÑ Rebirth", id: "500_rebirth", name: "Rebirth Transcendence", desc: "Rebirth 500 times", check: () => gameState.rebirthCount >= 500 },
    { cat: "üîÑ Rebirth", id: "1000_rebirth", name: "God of Rebirth", desc: "Rebirth 1,000 times", check: () => gameState.rebirthCount >= 1000 },
    { cat: "üîÑ Rebirth", id: "5000_rebirth", name: "Heat Death Survivor", desc: "Rebirth 5,000 times", check: () => gameState.rebirthCount >= 5000 },
    { cat: "üîÑ Rebirth", id: "10000_rebirth", name: "Saharsh Eternal", desc: "Rebirth 10,000 times. Why?", check: () => gameState.rebirthCount >= 10000 },
    { cat: "üîÑ Rebirth", id: "impossible_rebirth", name: "saharshed", desc: "Rebirth ", check: () => gameState.rebirthCount >= 1e10 },

    // ‚Äî Combos ‚Äî
    { cat: "üî• Combos", id: "combo_10", name: "Combo Master", desc: "Reach a 10x combo", check: () => peakCombo >= 10 },
    { cat: "üî• Combos", id: "combo_25", name: "Combo Legend", desc: "Reach a 25x combo", check: () => peakCombo >= 25 },
    { cat: "üî• Combos", id: "combo_50", name: "Combo Deity", desc: "Reach a 50x combo", check: () => peakCombo >= 50 },
    { cat: "üî• Combos", id: "combo_100", name: "Inhuman Speed", desc: "Reach a 100x combo", check: () => peakCombo >= 100 },
    { cat: "üî• Combos", id: "combo_200", name: "Are You A Bot?", desc: "Reach a 200x combo", check: () => peakCombo >= 200 },
    { cat: "üî• Combos", id: "impossible_combo", name: "nice autoclicker bro", desc: "Reach a combo around something", check: () => peakCombo >= 1e10 },

    // ‚Äî Golden Saharsh ‚Äî
    { cat: "‚≠ê Golden", id: "golden_click", name: "Golden Touch", desc: "Click a Golden Saharsh", check: () => (gameState.goldenClicks || 0) >= 1 },
    { cat: "‚≠ê Golden", id: "5_golden", name: "Midas", desc: "Click 5 Golden Saharshs", check: () => (gameState.goldenClicks || 0) >= 5 },
    { cat: "‚≠ê Golden", id: "10_golden", name: "Golden Collector", desc: "Click 10 Golden Saharshs", check: () => (gameState.goldenClicks || 0) >= 10 },
    { cat: "‚≠ê Golden", id: "25_golden", name: "Golden Obsession", desc: "Click 25 Golden Saharshs", check: () => (gameState.goldenClicks || 0) >= 25 },
    { cat: "‚≠ê Golden", id: "50_golden", name: "Fort Knox", desc: "Click 50 Golden Saharshs", check: () => (gameState.goldenClicks || 0) >= 50 },
    { cat: "‚≠ê Golden", id: "100_golden", name: "Golden God", desc: "Click 100 Golden Saharshs", check: () => (gameState.goldenClicks || 0) >= 100 },
    { cat: "‚≠ê Golden", id: "impossible_golden", name: "Golden Gerbert", desc: "who's gerbert? go find him ig", check: () => (gameState.goldenClicks || 0) >= 100000 },

    // ‚Äî Upgrades ‚Äî
    { cat: "‚¨ÜÔ∏è Upgrades", id: "first_upgrade", name: "Upgrader", desc: "Buy your first upgrade", check: () => gameState.ownedUpgrades.some(x => x > 0) },
    { cat: "‚¨ÜÔ∏è Upgrades", id: "10_upgrades", name: "Shopping Spree", desc: "Own 10 total upgrades", check: () => gameState.ownedUpgrades.reduce((a,b)=>a+b,0) >= 10 },
    { cat: "‚¨ÜÔ∏è Upgrades", id: "50_upgrades", name: "Upgrade Fanatic", desc: "Own 50 total upgrades", check: () => gameState.ownedUpgrades.reduce((a,b)=>a+b,0) >= 50 },
    { cat: "‚¨ÜÔ∏è Upgrades", id: "100_upgrades", name: "Upgrade Hoarder", desc: "Own 100 total upgrades", check: () => gameState.ownedUpgrades.reduce((a,b)=>a+b,0) >= 100 },
    { cat: "‚¨ÜÔ∏è Upgrades", id: "500_upgrades", name: "Upgrade Overlord", desc: "Own 500 total upgrades", check: () => gameState.ownedUpgrades.reduce((a,b)=>a+b,0) >= 500 },
    { cat: "‚¨ÜÔ∏è Upgrades", id: "1000_upgrades", name: "Upgrade Singularity", desc: "Own 1,000 total upgrades", check: () => gameState.ownedUpgrades.reduce((a,b)=>a+b,0) >= 1000 },
    { cat: "‚¨ÜÔ∏è Upgrades", id: "all_upgrades", name: "Completionist", desc: "Own at least 1 of every upgrade", check: () => gameState.ownedUpgrades.length >= avaliableUpgrades.length && gameState.ownedUpgrades.slice(0, avaliableUpgrades.length).every(x => x > 0) },
    { cat: "‚¨ÜÔ∏è Upgrades", id: "impossible_upgrades", name: "how did you get here", desc: "find the skeret upgrad!1!", check: () => gameState.ownedUpgrades.length >= avaliableUpgrades.length && gameState.ownedUpgrades.slice(0, avaliableUpgrades.length+1).every(x => x > 0) },

    // ‚Äî Power & Speed ‚Äî
    { cat: "‚ö° Power", id: "power_1k", name: "Strong Clicker", desc: "Reach 1,000 click power", check: () => clickPower >= 1000 },
    { cat: "‚ö° Power", id: "power_1m", name: "Power Overwhelming", desc: "Reach 1M click power", check: () => clickPower >= 1e6 },
    { cat: "‚ö° Power", id: "power_1b", name: "Infinite Power", desc: "Reach 1B click power", check: () => clickPower >= 1e9 },
    { cat: "‚ö° Power", id: "power_1t", name: "Power Unbound", desc: "Reach 1T click power", check: () => clickPower >= 1e12 },
    { cat: "‚ö° Power", id: "sps_1k", name: "Automation", desc: "Reach 1,000 SPS", check: () => autoPerSec >= 1000 },
    { cat: "‚ö° Power", id: "sps_1m", name: "Speed Demon", desc: "Reach 1M SPS", check: () => autoPerSec >= 1e6 },
    { cat: "‚ö° Power", id: "sps_1b", name: "Speed God", desc: "Reach 1B SPS", check: () => autoPerSec >= 1e9 },
    { cat: "‚ö° Power", id: "sps_1t", name: "Lightspeed", desc: "Reach 1T SPS", check: () => autoPerSec >= 1e12 },
    { cat: "‚ö° Power", id: "impossible_sps", name: "incremental sahrashian", desc: "Reach peak automation", check: () => autoPerSec >= 1e100 },

    // ‚Äî Multiplier ‚Äî
    { cat: "üèÖ Multiplier", id: "mult_2x", name: "Doubled", desc: "Reach x2.00 rebirth multiplier", check: () => getRebirthMultiplier() >= 2 },
    { cat: "üèÖ Multiplier", id: "mult_5x", name: "Quintuple", desc: "Reach x5.00 rebirth multiplier", check: () => getRebirthMultiplier() >= 5 },
    { cat: "üèÖ Multiplier", id: "mult_10x", name: "Decupled", desc: "Reach x10.00 rebirth multiplier", check: () => getRebirthMultiplier() >= 10 },
    { cat: "üèÖ Multiplier", id: "mult_25x", name: "Twenty-Five Fold", desc: "Reach x25.00 rebirth multiplier", check: () => getRebirthMultiplier() >= 25 },
    { cat: "üèÖ Multiplier", id: "mult_50x", name: "Fifty Fold", desc: "Reach x50.00 rebirth multiplier", check: () => getRebirthMultiplier() >= 50 },
    { cat: "üèÖ Multiplier", id: "mult_100x", name: "Centuple", desc: "Reach x100.00 rebirth multiplier", check: () => getRebirthMultiplier() >= 100 },
    { cat: "üèÖ Multiplier", id: "mult_1000x", name: "Thousandfold", desc: "Reach x1000.00 multiplier. Insane.", check: () => getRebirthMultiplier() >= 1000 },
    { cat: "üèÖ Multiplier", id: "impossible_mult", name: "that's a lot kinda", desc: "Reach calvined heights", check: () => getRebirthMultiplier() >= 1e10 },
  ];

  let achievementToastQueue = [];
  let showingToast = false;

  function showAchievementToast(name) {
    achievementToastQueue.push(name);
    if (!showingToast) processToastQueue();
  }

  function processToastQueue() {
    if (achievementToastQueue.length === 0) { showingToast = false; return; }
    showingToast = true;
    let name = achievementToastQueue.shift();
    let toast = document.getElementById("achievement-toast");
    document.getElementById("achievement-text").textContent = name;
    toast.classList.add("show");
    setTimeout(() => {
      toast.classList.remove("show");
      setTimeout(() => processToastQueue(), 500);
    }, 3000);
  }

  function checkAchievements() {
    for (let a of achievementDefs) {
      if (!gameState.achievements.includes(a.id) && a.check()) {
        gameState.achievements.push(a.id);
        showAchievementToast(a.name + " ‚Äî " + a.desc);
      }
    }
  }

  // ===== Achievement menu =====
  function updateAchievementDisplay() {
    let container = document.getElementById("achievement-list-container");
    container.innerHTML = "";
    let unlocked = 0;
    let categories = [];
    let catMap = {};

    for (let a of achievementDefs) {
      if (!catMap[a.cat]) {
        catMap[a.cat] = [];
        categories.push(a.cat);
      }
      let isUnlocked = gameState.achievements.includes(a.id);
      if (isUnlocked) unlocked++;
      catMap[a.cat].push({ ...a, unlocked: isUnlocked });
    }

    document.getElementById("achievement-count").textContent =
      `${unlocked} / ${achievementDefs.length} Unlocked`;
    document.getElementById("achievement-progress-fill").style.width =
      (unlocked / achievementDefs.length * 100) + "%";

    for (let cat of categories) {
      let label = document.createElement("div");
      label.className = "ach-category-label";
      let catUnlocked = catMap[cat].filter(a => a.unlocked).length;
      label.textContent = `${cat} (${catUnlocked}/${catMap[cat].length})`;
      container.appendChild(label);

      let grid = document.createElement("div");
      grid.id = "achievement-grid";
      for (let a of catMap[cat]) {
        let card = document.createElement("div");
        card.className = "achievement-card " + (a.unlocked ? "unlocked" : "locked");
        card.innerHTML = `
          <div class="ach-icon">${a.unlocked ? "‚úÖ" : "üîí"}</div>
          <div class="ach-name">${a.unlocked ? a.name : "???"}</div>
          <div class="ach-desc">${a.desc}</div>
        `;
        grid.appendChild(card);
      }
      container.appendChild(grid);
    }
  }

  document.getElementById("achievement-svg").addEventListener("click", () => {
    updateAchievementDisplay();
    document.getElementById("achievement-modal").classList.add("active");
  });

  document.getElementById("achievement-close-btn").addEventListener("click", () => {
    document.getElementById("achievement-modal").classList.remove("active");
  });

  // ===== Milestone progress bar =====
  function updateMilestone() {
    let nextUpgradeIndex = -1;
    for (let i = 0; i < avaliableUpgrades.length; i++) {
      let owned = gameState.ownedUpgrades[i] || 0;
      let cost = Math.ceil(avaliableUpgrades[i].cost * COST_MULTIPLIER ** owned);
      if (gameState.clickerCount < cost) {
        nextUpgradeIndex = i;
        break;
      }
    }
    let label = document.getElementById("milestone-label");
    let fill = document.getElementById("milestone-bar-fill");
    if (nextUpgradeIndex === -1) {
      label.textContent = "All upgrades affordable! üéâ";
      fill.style.width = "100%";
    } else {
      let owned = gameState.ownedUpgrades[nextUpgradeIndex] || 0;
      let cost = Math.ceil(avaliableUpgrades[nextUpgradeIndex].cost * COST_MULTIPLIER ** owned);
      let progress = Math.min(gameState.clickerCount / cost * 100, 100);
      label.textContent = `Next: ${avaliableUpgrades[nextUpgradeIndex].title} (${formatNumber(cost)} Saharsh)`;
      fill.style.width = progress + "%";
    }
  }

  // ===== Golden Saharsh =====
  let goldenActive = false;
  function spawnGoldenSaharsh() {
    if (goldenActive) return;
    goldenActive = true;
    let golden = document.getElementById("golden-saharsh");
    let section = document.getElementById("clicker-game-section");
    let w = section.offsetWidth;
    let h = section.offsetHeight;
    golden.style.left = (80 + Math.random() * (w - 160)) + "px";
    golden.style.top = (80 + Math.random() * (h - 160)) + "px";
    golden.style.display = "block";
    setTimeout(() => {
      if (goldenActive) {
        golden.style.display = "none";
        goldenActive = false;
      }
    }, 7000);
  }

  document.getElementById("golden-saharsh").addEventListener("click", () => {
    if (!goldenActive) return;
    goldenActive = false;
    document.getElementById("golden-saharsh").style.display = "none";
    gameState.goldenClicks++;

    let rewards = [
      () => {
        let bonus = Math.max(autoPerSec * 60, clickPower * 100, 1000);
        gameState.clickerCount += bonus;
        gameState.totalSaharshEarned += bonus;
        showAchievementToast(`Golden Saharsh! +${formatNumber(bonus)} Saharsh!`);
      },
      () => {
        let bonus = Math.max(autoPerSec * 120, clickPower * 200, 5000);
        gameState.clickerCount += bonus;
        gameState.totalSaharshEarned += bonus;
        showAchievementToast(`MEGA Golden Saharsh! +${formatNumber(bonus)} Saharsh!`);
      },
      () => {
        let bonus = Math.max(autoPerSec * 30, clickPower * 50, 500);
        gameState.clickerCount += bonus;
        gameState.totalSaharshEarned += bonus;
        showAchievementToast(`Lucky Saharsh! +${formatNumber(bonus)} Saharsh!`);
      }
    ];
    rewards[Math.floor(Math.random() * rewards.length)]();
    checkAchievements();
    updateCountDisplay();
  });

  function scheduleGolden() {
    let delay = 30000 + Math.random() * 60000;
    setTimeout(() => {
      if (document.getElementById("clicker-game-section").style.display !== "none") {
        spawnGoldenSaharsh();
      }
      scheduleGolden();
    }, delay);
  }
  scheduleGolden();

  // ===== Main clicker =====
  clicker.addEventListener("click", (e) => {
    updateCombo();
    let comboMult = getComboMultiplier();
    let earned = Math.floor(clickPower * comboMult);
    gameState.clickerCount += earned;
    gameState.totalClicks++;
    gameState.totalSaharshEarned += earned;
    updateCountDisplay();
    spawnParticle(e.clientX, e.clientY, "+" + formatNumber(earned));
    playClickSound();
    if (comboCount >= 5) triggerShake();
    checkAchievements();
  });

  addEventListener("mousemove", (e) => {
    document.getElementById("customCursor").style.transform = `translate(${e.clientX - 10}px, ${e.clientY - 10}px)`;
  }, {passive: true});

  // Auto-click loop with integer accumulator
  setInterval(() => {
    autoAccumulator += autoPerSec / 15;
    let toAdd = Math.floor(autoAccumulator);
    if (toAdd > 0) {
      autoAccumulator -= toAdd;
      gameState.clickerCount += toAdd;
      gameState.totalSaharshEarned += toAdd;
    }
    updateCountDisplay();
    updateStatsDisplay();
    updateMilestone();
  }, 1000/15);

  setInterval(() => {
    if (document.getElementById("clicker-upgrade-section").style.display !== "none") {
      updateUpgradeSection();
    }
  }, 500);

  setInterval(() => { checkAchievements(); }, 2000);

  setInterval(() => {
    localStorage.setItem("gameState-v" + GAMEVERSION, JSON.stringify(gameState));
  }, 1000);

  // ===== Bulk buy =====
  function getCostForN(upgradeIndex, n) {
    let total = 0;
    let baseCost = avaliableUpgrades[upgradeIndex].cost;
    let currentOwned = gameState.ownedUpgrades[upgradeIndex] || 0;
    for (let j = 0; j < n; j++) {
      total += Math.ceil(baseCost * COST_MULTIPLIER ** (currentOwned + j));
    }
    return total;
  }

  document.getElementById("bulk-buy-toggle").addEventListener("click", () => {
    bulkIndex = (bulkIndex + 1) % bulkOptions.length;
    bulkBuyAmount = bulkOptions[bulkIndex];
    document.getElementById("bulk-buy-toggle").textContent = `Buy: x${bulkBuyAmount}`;
    updateUpgradeSection();
  });

  function updateUpgradeSection() {
    if (document.getElementById("clicker-upgrade-section").style.display === "none") return;
    upgradeSection.innerHTML = "";

    for (let i = 0; i < avaliableUpgrades.length; ++i) {
      let upgrade = avaliableUpgrades[i];
      let owned = gameState.ownedUpgrades[i] || 0;
      let cost = getCostForN(i, bulkBuyAmount);

      let element = document.createElement("div");
      element.classList.add("upgrade-item");
      element.setAttribute("data-index", i);

      let canAfford = gameState.clickerCount >= cost;

      let isVisible;
      if (i === 0) {
        isVisible = true;
      } else {
        let prevOwned = (gameState.ownedUpgrades[i - 1] || 0) > 0;
        let prevCost = avaliableUpgrades[i - 1].cost;
        let canAffordPrev = gameState.clickerCount >= prevCost;
        isVisible = prevOwned || canAffordPrev;
      }

      if (!isVisible) {
        element.innerHTML = `<pre style="white-space:pre-wrap"><strong>???</strong> <i class="small">(??? Saharsh)</i></pre>`;
        element.classList.add("hidden");
      } else if (!canAfford) {
        let desc = upgrade.subtitle ? upgrade.subtitle.replace(/\n/g, "<br>") : "";
        element.innerHTML = `<pre style="white-space:pre-wrap"><strong>${upgrade.title}</strong> <i class="small">(${formatNumber(cost)} Saharsh${bulkBuyAmount > 1 ? ' for ' + bulkBuyAmount : ''})</i> <i class="small">(owned: ${owned})</i>${desc ? "<p class=\"small\">" + desc + "</p>" : ""}</pre>`;
        element.classList.add("locked");
      } else {
        let desc = upgrade.subtitle ? upgrade.subtitle.replace(/\n/g, "<br>") : "";
        element.innerHTML = `<pre style="white-space:pre-wrap"><strong>${upgrade.title}</strong> <i class="small">(${formatNumber(cost)} Saharsh${bulkBuyAmount > 1 ? ' for ' + bulkBuyAmount : ''})</i> <i class="small">(owned: ${owned})</i>${desc ? "<p class=\"small\">" + desc + "</p>" : ""}</pre>`;
      }

      upgradeSection.appendChild(element);
    }
  }

  document.getElementById("upgrade-svg").addEventListener("click", () => {
    document.getElementById("clicker-game-section").style.display = "none";
    document.getElementById("clicker-upgrade-section").style.display = "block";
    updateUpgradeSection();
  });

  document.getElementById("exit-upgrade-svg").addEventListener("click", () => {
    document.getElementById("clicker-game-section").style.display = "block";
    document.getElementById("clicker-upgrade-section").style.display = "none";
  });

  upgradeSection.addEventListener("click", (e) => {
    let target = e.target.closest(".upgrade-item");
    if (target && !target.classList.contains("locked") && !target.classList.contains("hidden")) {
      let index = parseInt(target.getAttribute("data-index"));
      let cost = getCostForN(index, bulkBuyAmount);
      if (gameState.clickerCount >= cost) {
        gameState.clickerCount -= cost;
        gameState.ownedUpgrades[index] += bulkBuyAmount;
        computePowers();
        updateCountDisplay();
        updateUpgradeSection();
        checkAchievements();
        playClickSound();
      }
    }
  });

  // ===== Rebirth system =====
  function calcRebirthTokens() {
    let earned = gameState.totalSaharshEarned;
    return Math.max(0, Math.floor(Math.sqrt(earned / REBIRTH_THRESHOLD)));
  }

  function canRebirth() {
    return gameState.clickerCount >= REBIRTH_THRESHOLD || gameState.totalSaharshEarned >= REBIRTH_THRESHOLD;
  }

  document.getElementById("rebirth-svg").addEventListener("click", () => {
    let tokens = calcRebirthTokens();
    let currentMult = getRebirthMultiplier();
    let newMult = 1 + (gameState.rebirthTokens + tokens) * REBIRTH_MULT_PER_TOKEN;

    document.getElementById("rebirth-current-mult").textContent = "x" + currentMult.toFixed(2);
    document.getElementById("rebirth-new-mult").textContent = "x" + newMult.toFixed(2);
    document.getElementById("rebirth-tokens-earned").textContent = tokens;

    let confirmBtn = document.getElementById("rebirth-confirm-btn");

    if (!canRebirth()) {
      document.getElementById("rebirth-requirement").textContent =
        `‚ö†Ô∏è Need at least ${formatNumber(REBIRTH_THRESHOLD)} total Saharsh earned to rebirth! (Current: ${formatNumber(gameState.totalSaharshEarned)})`;
      confirmBtn.disabled = true;
      confirmBtn.style.opacity = "0.5";
    } else if (tokens <= 0) {
      document.getElementById("rebirth-requirement").textContent =
        `‚ö†Ô∏è You won't gain any tokens yet. Earn more Saharsh!`;
      confirmBtn.disabled = true;
      confirmBtn.style.opacity = "0.5";
    } else {
      document.getElementById("rebirth-requirement").textContent =
        `‚úÖ Ready to rebirth! You'll gain ${tokens} token(s) for +${(tokens * REBIRTH_MULT_PER_TOKEN * 100).toFixed(0)}% multiplier.`;
      confirmBtn.disabled = false;
      confirmBtn.style.opacity = "1";
    }

    document.getElementById("rebirth-modal").classList.add("active");
  });

  document.getElementById("rebirth-cancel-btn").addEventListener("click", () => {
    document.getElementById("rebirth-modal").classList.remove("active");
  });

  document.getElementById("rebirth-confirm-btn").addEventListener("click", () => {
    if (!canRebirth()) return;
    let tokens = calcRebirthTokens();
    if (tokens <= 0) return;

    gameState.rebirthTokens += tokens;
    gameState.rebirthCount++;
    gameState.clickerCount = 0;
    gameState.ownedUpgrades = new Array(avaliableUpgrades.length).fill(0);
    gameState.totalSaharshEarned = 0;
    autoAccumulator = 0;

    computePowers();
    updateCountDisplay();
    updateStatsDisplay();
    updateMilestone();

    document.getElementById("rebirth-modal").classList.remove("active");
    showAchievementToast(`Rebirth #${gameState.rebirthCount}! Multiplier: x${getRebirthMultiplier().toFixed(2)}`);
    checkAchievements();

    let flash = document.createElement("div");
    flash.style.cssText = "position:fixed;top:0;left:0;width:100%;height:100%;background:white;z-index:9999998;pointer-events:none;opacity:1;transition:opacity 1s;";
    document.body.appendChild(flash);
    setTimeout(() => { flash.style.opacity = "0"; }, 50);
    setTimeout(() => { flash.remove(); }, 1100);
  });

  // ===== Settings =====
  document.getElementById("settings-svg").addEventListener("click", () => {
    updateSettingsButtons();
    document.getElementById("settings-modal").classList.add("active");
  });

  document.getElementById("settings-close-btn").addEventListener("click", () => {
    document.getElementById("settings-modal").classList.remove("active");
  });

  function updateSettingsButtons() {
    document.getElementById("toggle-particles-btn").textContent =
      `‚ú® Particles: ${gameState.settings.particles ? "ON" : "OFF"}`;
    document.getElementById("toggle-shake-btn").textContent =
      `üì≥ Screen Shake: ${gameState.settings.screenShake ? "ON" : "OFF"}`;
    document.getElementById("toggle-sound-btn").textContent =
      `üîä Click Sound: ${gameState.settings.clickSound ? "ON" : "OFF"}`;
  }

  document.getElementById("toggle-particles-btn").addEventListener("click", () => {
    gameState.settings.particles = !gameState.settings.particles;
    updateSettingsButtons();
  });
  document.getElementById("toggle-shake-btn").addEventListener("click", () => {
    gameState.settings.screenShake = !gameState.settings.screenShake;
    updateSettingsButtons();
  });
  document.getElementById("toggle-sound-btn").addEventListener("click", () => {
    gameState.settings.clickSound = !gameState.settings.clickSound;
    updateSettingsButtons();
  });

  document.getElementById("export-save-btn").addEventListener("click", () => {
    let data = btoa(JSON.stringify(gameState));
    navigator.clipboard.writeText(data).then(() => {
      showAchievementToast("Save copied to clipboard!");
    }).catch(() => {
      prompt("Copy this save data:", data);
    });
  });

  document.getElementById("import-save-btn").addEventListener("click", () => {
    let data = prompt("Paste your save data:");
    if (!data) return;
    try {
      let parsed = JSON.parse(atob(data));
      gameState = { ...gameState, ...parsed };
      while (gameState.ownedUpgrades.length < avaliableUpgrades.length) {
        gameState.ownedUpgrades.push(0);
      }
      let ds = { particles: true, screenShake: true, clickSound: true };
      gameState.settings = { ...ds, ...(gameState.settings || {}) };
      computePowers();
      updateCountDisplay();
      updateStatsDisplay();
      showAchievementToast("Save imported successfully!");
    } catch (e) {
      alert("Invalid save data!");
    }
  });

  document.getElementById("hard-reset-btn").addEventListener("click", () => {
    if (confirm("Are you SURE you want to delete ALL progress? This cannot be undone!")) {
      if (confirm("Really? EVERYTHING will be gone forever!")) {
        localStorage.removeItem("gameState-v" + GAMEVERSION);
        location.reload();
      }
    }
  });

  document.querySelectorAll(".modal-overlay").forEach(modal => {
    modal.addEventListener("click", (e) => {
      if (e.target === modal) modal.classList.remove("active");
    });
  });

  // ===== Keyboard shortcuts =====
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
      document.querySelectorAll(".modal-overlay").forEach(m => m.classList.remove("active"));
      if (document.getElementById("clicker-upgrade-section").style.display !== "none") {
        document.getElementById("clicker-game-section").style.display = "block";
        document.getElementById("clicker-upgrade-section").style.display = "none";
      }
    }
    if (e.key === "u" || e.key === "U") {
      if (document.querySelector(".modal-overlay.active")) return;
      if (document.getElementById("clicker-upgrade-section").style.display === "none" ||
          document.getElementById("clicker-upgrade-section").style.display === "") {
        document.getElementById("clicker-game-section").style.display = "none";
        document.getElementById("clicker-upgrade-section").style.display = "block";
        updateUpgradeSection();
      } else {
        document.getElementById("clicker-game-section").style.display = "block";
        document.getElementById("clicker-upgrade-section").style.display = "none";
      }
    }
  });
</script>
</body>
</html>
